# PDF分页合并工具

这个工具可以将多个PDF文件按页面生成独立的合并文件，并提供详细的进度显示和处理时间统计。

## 功能说明

假设有三个PDF文件A、B、C，程序会生成3个独立的结果文件：

- **第1页合并结果.pdf**: A的第1页 + B的第1页 + C的第1页
- **第2页合并结果.pdf**: A的第2页 + B的第2页 + C的第2页  
- **第3页合并结果.pdf**: A的第3页 + B的第3页 + C的第3页

每个结果文件都是一个独立的PDF，包含所有源PDF的对应页面。

## ✨ 主要特性

- 📊 **实时进度条**: 显示文件读取和页面处理进度
- ⏱️ **时间统计**: 详细的开始时间、结束时间和总耗时
- 📈 **性能分析**: 每页处理时间和平均处理速度
- 📁 **文件信息**: 显示源文件大小和数量
- 🎯 **智能处理**: 自动跳过不存在的页面
- 🔍 **详细日志**: 每个步骤的状态反馈

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 方法1：使用默认目录

将要合并的PDF文件放入 `PDF插入/原始文件/` 目录，然后运行：

```bash
python pdf_interleave_merger.py
```

程序会自动：

1. 扫描 `PDF插入/原始文件/` 目录中的所有PDF文件
2. 按文件名排序
3. 为每一页生成独立的合并文件
4. 将结果保存到 `PDF插入/最终文件/` 目录

### 方法2：自定义使用

您也可以修改代码中的路径或导入函数来自定义使用：

```python
from pdf_interleave_merger import merge_pdfs_by_page_groups

pdf_files = ['path/to/file1.pdf', 'path/to/file2.pdf', 'path/to/file3.pdf']
output_dir = 'output/directory'

merge_pdfs_by_page_groups(pdf_files, output_dir)
```

## 目录结构

```
├── pdf_interleave_merger.py    # 主程序
├── requirements.txt            # 依赖包 (PyPDF2, tqdm)
├── README.md                   # 说明文档
└── PDF插入/
    ├── 原始文件/              # 放置要合并的PDF文件
    │   ├── 组合 1.pdf
    │   ├── 组合 2.pdf
    │   └── 组合 3.pdf
    └── 最终文件/              # 输出目录
        ├── 第1页合并结果.pdf   # 所有PDF的第1页
        ├── 第2页合并结果.pdf   # 所有PDF的第2页
        └── 第3页合并结果.pdf   # 所有PDF的第3页
```

## 注意事项

- 如果PDF文件页数不同，程序会自动跳过不存在的页面
- 结果文件数量等于最大页数的PDF文件页数
- 确保有足够的磁盘空间来存储生成的文件
- 支持任意数量的PDF文件合并（不仅仅是3个）
- 处理大文件时会显示详细的进度和时间信息

## 示例输出

```
🔥 PDF分页合并工具
==================================================
📝 功能：将多个PDF按页面生成独立的合并文件
💡 例如：第1页合并结果.pdf = A的第1页 + B的第1页 + C的第1页
==================================================
🔍 扫描PDF文件...
找到3个PDF文件:
  1. 组合 1.pdf (0.1 MB)
  2. 组合 2.pdf (1.7 MB)
  3. 组合 3.pdf (0.6 MB)

🚀 开始处理 3 个PDF文件...
⏰ 开始处理时间: 2025-05-30 19:20:03
🔍 验证文件存在性...
✅ 所有文件验证通过
📖 正在读取PDF文件...
读取文件: 100%|█████████████| 3/3 [00:00<00:00, 943.67文件/s]
📄 最大页数: 3
🎯 将生成 3 个结果PDF文件

🔄 开始生成分页合并文件...
  ✅ 生成: 第1页合并结果.pdf (包含: 组合 1.pdf, 组合 2.pdf, 组合 3.pdf) - 耗时: 0.00秒
  ✅ 生成: 第2页合并结果.pdf (包含: 组合 1.pdf, 组合 2.pdf, 组合 3.pdf) - 耗时: 0.01秒
  ✅ 生成: 第3页合并结果.pdf (包含: 组合 1.pdf, 组合 2.pdf, 组合 3.pdf) - 耗时: 0.03秒
处理第3页: 100%|███████████| 3/3 [00:00<00:00, 85.56页/s]

🎉 所有文件生成完成! 共生成 3 个PDF文件
⏰ 完成时间: 2025-05-30 19:20:03
⏱️  总耗时: 0.06 秒
📊 平均每页处理时间: 0.02 秒
🔒 正在关闭文件...

🎊 处理完成!
输出目录: /path/to/PDF插入/最终文件
🕒 程序总运行时间: 0.06 秒
```

## 依赖库

- **PyPDF2**: PDF文件处理
- **tqdm**: 进度条显示
- **pathlib**: 文件路径处理
- **time**: 时间统计功能 